<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Quantum Stealth: Анонимизатор</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0f1020;
            --bg-secondary: #1a1a2e;
            --accent-color: #4a4e69;
            --neon-color: #22223b;
            --text-color: #f2e9e4;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, var(--bg-primary), var(--bg-secondary));
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Orbitron', sans-serif;
            overflow: hidden;
            perspective: 1000px;
        }

        .quantum-container {
            background: rgba(26, 26, 46, 0.9);
            border-radius: 25px;
            padding: 40px;
            width: 100%;
            max-width: 550px;
            backdrop-filter: blur(20px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            border: 3px solid var(--neon-color);
            position: relative;
            transform-style: preserve-3d;
            transform: rotateX(10deg);
            transition: all 0.5s ease;
        }

        .quantum-container:hover {
            transform: rotateX(0) scale(1.02);
        }

        .quantum-title {
            text-align: center;
            color: var(--text-color);
            margin-bottom: 30px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 3px;
            position: relative;
        }

        .quantum-title::before {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            width: 100px;
            height: 3px;
            background: linear-gradient(to right, transparent, var(--accent-color), transparent);
            transform: translateX(-50%);
        }

        .permission-section {
            background: rgba(45, 45, 75, 0.5);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .permission-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(30, 30, 60, 0.7);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .permission-item:hover {
            transform: scale(1.05);
            background: rgba(50, 50, 90, 0.8);
        }

        .btn-quantum {
            background: linear-gradient(135deg, #4a4e69, #22223b);
            color: var(--text-color);
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-quantum::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(120deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: all 0.5s ease;
        }

        .btn-quantum:hover::before {
            left: 100%;
        }

        .btn-quantum:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        #anonymizationStatus {
            background: rgba(30, 30, 60, 0.7);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .loader {
            border: 4px solid transparent;
            border-top: 4px solid var(--accent-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="quantum-container animate__animated animate__fadeIn">
        <h2 class="quantum-title">Quantum Stealth</h2>

        <div class="permission-section">
            <div class="permission-item">
                <span>Геолокация</span>
                <button class="btn btn-sm btn-quantum" onclick="requestPermission('location')">Разрешить</button>
            </div>
            <div class="permission-item">
                <span>Камера</span>
                <button class="btn btn-sm btn-quantum" onclick="requestPermission('camera')">Разрешить</button>
            </div>
            <div class="permission-item">
                <span>Микрофон</span>
                <button class="btn btn-sm btn-quantum" onclick="requestPermission('microphone')">Разрешить</button>
            </div>
        </div>

        <div class="mb-3">
            <select id="locationSelect" class="form-control">
                <option value="kazan">Казань</option>
                <option value="moscow">Москва</option>
                <option value="spb">Санкт-Петербург</option>
            </select>
        </div>

        <button class="btn btn-block btn-quantum mt-3" onclick="startAnonymization()">
            Активировать Защиту
        </button>

        <div id="anonymizationStatus" class="mt-3">
            <div class="loader"></div>
        </div>
    </div>

    <script>
        // Расширенная конфигурация локаций
        const LOCATIONS = {
            kazan: { 
                lat: 55.796127, 
                lon: 49.106414,
                ip: '95.173.128.0',
                yandexMapsConfig: {
                    center: [55.796127, 49.106414],
                    zoom: 12,
                    type: 'yandex#map'
                }
            },
            // Другие локации...
        };

        // Функция запроса разрешений
        function requestPermission(type) {
            switch(type) {
                case 'location':
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            alert('Геолокация разрешена');
                        },
                                                (error) => {
                            console.error('Ошибка геолокации:', error);
                            alert('Не удалось получить геолокацию');
                        }
                    );
                    break;
                case 'camera':
                    navigator.mediaDevices.getUserMedia({ video: true })
                        .then(() => alert('Доступ к камере разрешен'))
                        .catch(err => console.error('Ошибка камеры:', err));
                    break;
                case 'microphone':
                    navigator.mediaDevices.getUserMedia({ audio: true })
                        .then(() => alert('Доступ к микрофону разрешен'))
                        .catch(err => console.error('Ошибка микрофона:', err));
                    break;
            }
        }

        // Функция глубокой анонимизации
        function startAnonymization() {
            const locationSelect = document.getElementById('locationSelect');
            const selectedLocation = LOCATIONS[locationSelect.value];
            const statusDiv = document.getElementById('anonymizationStatus');

            // Расширенная анонимизация
            const anonymizationConfig = {
                location: {
                    lat: selectedLocation.lat + (Math.random() - 0.5) * 0.05,
                    lon: selectedLocation.lon + (Math.random() - 0.5) * 0.05
                },
                ip: `${selectedLocation.ip}.${Math.floor(Math.random() * 255)}`,
                userAgent: navigator.userAgent.replace(/\(.*?\)/, '(Anonymized)')
            };

            // Подмена геолокации
            function mockGeolocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition = function(success) {
                        success({
                            coords: {
                                latitude: anonymizationConfig.location.lat,
                                longitude: anonymizationConfig.location.lon,
                                accuracy: 50
                            }
                        });
                    };
                }
            }

            // Имитация Яндекс.Карт
            function spoofYandexMaps() {
                // Эмуляция объекта карты
                window.ymaps = {
                    ready: function(callback) {
                        callback();
                    },
                    Map: function() {
                        return {
                            setCenter: () => {},
                            setZoom: () => {}
                        };
                    },
                    geolocation: {
                        get: () => Promise.resolve({
                            location: {
                                coordinates: [
                                    selectedLocation.lat, 
                                    selectedLocation.lon
                                ]
                            }
                        })
                    }
                };
            }

            // Криптографическая защита
            function enhancedCryptoProtection() {
                // Переопределение crypto API
                if (window.crypto && window.crypto.getRandomValues) {
                    const originalGetRandomValues = window.crypto.getRandomValues;
                    window.crypto.getRandomValues = function(array) {
                        for (let i = 0; i < array.length; i++) {
                            array[i] = Math.floor(Math.random() * 0xFFFFFFFF);
                        }
                        return array;
                    };
                }

                // Блокировка WebRTC утечек
                if (window.RTCPeerConnection) {
                    window.RTCPeerConnection = function() {
                        return {
                            createOffer: () => Promise.resolve({ sdp: 'blocked' }),
                            createAnswer: () => Promise.resolve({ sdp: 'blocked' })
                        };
                    };
                }
            }

            // Маскировка системных параметров
            function spoofSystemParameters() {
                // Модификация navigator
                Object.defineProperties(navigator, {
                    userAgent: { 
                        value: anonymizationConfig.userAgent 
                    },
                    platform: { 
                        value: 'Anonymized' 
                    },
                    language: { 
                        value: 'ru-RU' 
                    }
                });

                // Маскировка экрана
                if (window.screen) {
                    Object.defineProperties(window.screen, {
                        width: { value: 1920 },
                        height: { value: 1080 },
                        colorDepth: { value: 24 },
                        pixelDepth: { value: 24 }
                    });
                }
            }

            // Управление куками и локальным хранилищем
            function manageCookiesAndStorage() {
                // Блокировка и очистка существующих куков
                if (document.cookie) {
                    document.cookie.split(";").forEach(function(cookie) {
                        var eqPos = cookie.indexOf("=");
                        var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
                        document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
                    });
                }

                // Очистка локального хранилища
                localStorage.clear();
                sessionStorage.clear();

                // Установка защищенных куков
                document.cookie = `anonymized=true; path=/; SameSite=Strict; Secure`;
            }

            // Комплексная защита
            function initializeQuantumProtection() {
                mockGeolocation();
                spoofYandexMaps();
                enhancedCryptoProtection();
                spoofSystemParameters();
                manageCookiesAndStorage();

                // Обновление статуса
                statusDiv.innerHTML = `
                    🔒 Анонимизация активирована:<br>
                    📍 Локация: ${locationSelect.value.toUpperCase()}<br>
                    🌐 IP: ${anonymizationConfig.ip}<br>
                    🕵️ Защита: Максимальная
                `;

                // Визуальные эффекты
                statusDiv.classList.add('animate__animated', 'animate__pulse');
                document.body.style.background = 'linear-gradient(135deg, #0f1020, #16213e)';
            }

            // Запуск полной защиты
            initializeQuantumProtection();

            // Дополнительная защита от закрытия
            window.addEventListener('beforeunload', (event) => {
                event.preventDefault();
                event.returnValue = 'Вы уверены, что хотите покинуть защищенную сессию?';
            });
        }
    </script>
</body>
</html>
